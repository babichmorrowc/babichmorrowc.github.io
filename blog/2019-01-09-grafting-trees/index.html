<!DOCTYPE html>
<html lang="en" dir="ltr"><head>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.128.0">
<title>Grafting phylogenies | Cecina Babich Morrow</title>


<meta property="twitter:site" content="@babichmorrowc">
<meta property="twitter:creator" content="@babichmorrowc">







  
    
  
<meta name="description" content="Using R to graft phylogenies together.">


<meta property="og:site_name" content="Cecina Babich Morrow">
<meta property="og:title" content="Grafting phylogenies | Cecina Babich Morrow">
<meta property="og:description" content="Using R to graft phylogenies together." />
<meta property="og:type" content="page" />
<meta property="og:url" content="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/" />
<meta property="og:locale" content="en">




    
        <meta property="og:image" content="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/featured.png" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/featured.png" >
    
    
  
  <meta itemprop="name" content="Grafting phylogenies">
  <meta itemprop="description" content="Using R to graft phylogenies together.">
  <meta itemprop="datePublished" content="2019-01-18T21:13:14-05:00">
  <meta itemprop="dateModified" content="2019-01-18T21:13:14-05:00">
  <meta itemprop="wordCount" content="1706">
  <meta itemprop="image" content="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/featured.png">
  <meta itemprop="keywords" content="R,Phylogenetics,Evolution">
  
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=130807002"></script>
      <script>
        var doNotTrack = false;
        if ( true ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', '130807002');
        }
      </script>
    
  


  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon_io/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon_io/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.efe606a4a38248e49cb083e10d55824649e30549b2438e91c5513e6ccbbb543d.css" integrity="sha256-7&#43;YGpKOCSOScsIPhDVWCRknjBUmyQ46RxVE&#43;bMu7VD0=" media="screen">
  
  
  <script src="/panelset.min.ed1ac24b6e16f4e2481e3d1d098ae66f5bc77438aef619e6e266d8ac5b00dc72.js" type="text/javascript"></script>
  
  
  <script src="/main.min.8775cb64fbeada525af486d0e6a80a9042ba0c7a7958fc22c03e42d5abc3fe1f.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="https://babichmorrowc.github.io/" title="Home">
      <img src="/img/favicon_io/favicon.ico" class="dib db-l h2 w-auto" alt="Cecina Babich Morrow">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="About Cecina">About</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/blog/" title="Blog">Blog</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/project/" title="Project Portfolio">Projects</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/talk/" title="Talks">Talks</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/publication/" title="Publications">Publications</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/contact/" title="Contact">Contact</a>
      
      
    </div>
  </nav>
</header>

<main class="page-main pa4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 ph4-l">
      <header class="post-header">
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">Grafting phylogenies</h1>
        <h4 class="f4 mt0 mb4 lh-title measure">Using R to graft phylogenies together.</h4>
        <p class="f6 measure lh-copy mv1">By Cecina Babich Morrow in <a href="https://babichmorrowc.github.io/categories/r">R</a>  <a href="https://babichmorrowc.github.io/categories/phylogenetics">phylogenetics</a>  <a href="https://babichmorrowc.github.io/categories/evolution">evolution</a> </p>
        <p class="f7 db mv0 ttu">January 18, 2019</p>

      

      </header>
      <section class="post-body pt5 pb4">
        


<div id="inspiration-for-this-post" class="section level1">
<h1>Inspiration for this post</h1>
<p>This post comes from the finishing touches I needed to put on a paper about <a href="https://babichmorrowc.github.io/project/life_history/">life history evolution</a>. The paper compares life history traits across the four groups of tetrapods (amphibians, reptiles, mammals, and birds), so when I carried out the nitty gritty phylogenetic analyses, I used four separate phylogenies. When it came time to make a figure to visualize those analyses, however, I ended up with an unwieldy (and unpublishable) 16-panel figure (four phylogenies by four traits). One of my coauthors suggested using a tetrapod supertree to visualize the evolution of the traits across all four classes simultaneously.</p>
<div id="uyeda-et-al.-2017" class="section level2">
<h2>Uyeda et al. 2017</h2>
<p>Uyeda et al. did something similar in their 2017 paper <a href="https://www.journals.uchicago.edu/doi/10.1086/692326">The evolution of energetic scaling across the vertebrate tree of life</a>. They stitched together fish, amphibian, squamate, bird, and mammal phylogenies together to visualize metabolic rate across all vertebrates:</p>
<figure>
<img class="special-img-class" style="width:75%" src="/img/uyeda_figure.png" />
<figcaption>
Figure 1 from Uyeda et al. 2017
</figcaption>
</figure>
<p>At first, I was very hopeful that I would be able to download this supertree and prune it to the taxa in my analysis since the authors were using the same clade specific phylogenies that I was. The phylogeny is available on Data Dryad (<a href="https://datadryad.org/resource/doi:10.5061/dryad.3c6d2" class="uri">https://datadryad.org/resource/doi:10.5061/dryad.3c6d2</a>). Unfortunately, after downloading that phylogeny and pruning it to include species I used in my analysis, I ended up with approximately 15% of the species I analyzed in the resulting tree.</p>
</div>
</div>
<div id="into-the-code" class="section level1">
<h1>Into the code</h1>
<p>Since my easy solution didn’t pan out and I couldn’t get enough information from the supplemental material for the paper to replicate their analyses, I looked on GitHub to try to find Uyeda’s code. Hooray for GitHub once again, because the repository for the paper can be found here: <a href="https://github.com/uyedaj/bmr" class="uri">https://github.com/uyedaj/bmr</a>. The <a href="https://github.com/uyedaj/bmr/blob/master/R/ManuscriptNotebook.Rmd">RMarkdown</a> details the analyses for the paper, including the process for making the full tree.</p>
<p>Start with loading the necessary packages.</p>
<pre class="r"><code>library(phytools)
## Loading required package: ape
## Loading required package: maps</code></pre>
<pre class="r"><code>library(geiger)</code></pre>
<div id="the-original-phylogenies" class="section level2">
<h2>The original phylogenies</h2>
<p>I was working with four separate phylogenies: amphibians, squamates, birds, and mammals. For amphibians, I used a congruified time-tree from the <code>PhyloOrchard</code> package (O’Meara et al. 2013) that was constructed using the Alfaro et al. timetree of gnathostomes (Alfaro et al. 2009) as the reference and the Pyron and Wiens amphibian phylogeny as the target (Pyron and Wiens 2011).</p>
<pre class="r"><code>length(amphibiantree$tip.label)
## [1] 2871</code></pre>
<pre class="r"><code>plot(amphibiantree, type = &quot;fan&quot;, show.tip.label = FALSE)</code></pre>
<p><img src="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>For squamates, I used the Zheng and Wiens time-calibrated phylogeny (Zheng and Wiens 2016).</p>
<pre class="r"><code>length(squamatetree$tip.label)
## [1] 378</code></pre>
<pre class="r"><code>plot(squamatetree, type = &quot;fan&quot;, show.tip.label = FALSE)</code></pre>
<p><img src="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>For birds, I used the Jetz phylogeny (Jetz et al. 2012).</p>
<pre class="r"><code>length(birdtree$tip.label)
## [1] 9993</code></pre>
<pre class="r"><code>plot(birdtree, type = &quot;fan&quot;, show.tip.label = FALSE)</code></pre>
<p><img src="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>For mammals, I used the supertree from Fritz et al. 2009.</p>
<pre class="r"><code>length(mammaltree$tip.label)
## [1] 5020</code></pre>
<pre class="r"><code>plot(mammaltree, type = &quot;fan&quot;, show.tip.label = FALSE)</code></pre>
<p><img src="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="reading-in-trees" class="section level2">
<h2>Reading in trees</h2>
<p>The first step of the process is reading in the individual phylogenies you want to stitch together. This step is straightforward, with one exception: you cannot have species that are present in multiple of the individual trees. For example, my squamate phylogeny included <em>Gallus gallus</em> (red junglefowl) and <em>Dromaius novaehollandia</em> (emu). Since these species were also present in my bird phylogeny, I got the following error: <code>Found matching tips in 'subtree' and 'phy'</code>. To solve this problem, I just removed these tips from the squamate tree:</p>
<pre class="r"><code>squamatetree &lt;- drop.tip(phy = squamatetree, tip = c(&quot;Gallus_gallus&quot;, &quot;Dromaius_novaehollandiae&quot;))</code></pre>
<p>I ended up with the following list of trees and corresponding tip labels:</p>
<pre class="r"><code>tree_list &lt;- list(amphib=amphibiantree, birds=birdtree, squam=squamatetree, mamm=mammaltree)
class(tree_list) &lt;- &quot;multiPhylo&quot;</code></pre>
</div>
<div id="make-a-tree-with-orders" class="section level2">
<h2>Make a tree with orders</h2>
<p>In Uyeda et al. (2017), the authors were creating a phylogeny for all vertebrates, but for my analyses I was only examining tetrapods, so I didn’t have a fish phylogeny to include. The original code from Uyeda et al. to create a tree with the 5 vertebrate orders looks like this:</p>
<pre class="r"><code>tip.labels &lt;- c(&quot;fish&quot;, &quot;amphib&quot;, &quot;squam&quot;, &quot;birds&quot;, &quot;mamm&quot;)

## Make a tree with just orders:
edge &lt;- matrix(c(9, 4,
  9, 3,
  8, 5,
  8, 9,
  7, 8,
  7, 2,
  6, 7,
  6, 1), byrow=TRUE, ncol=2)
## Dates from Timetree of life (timetree.org)
edge.length &lt;- c(274.9, 274.9, 324.5, 324.5-274.9, 382.9-324.5, 382.9, 454.6-382.9 , 454.6)
Nnode &lt;- 4
ordertree &lt;- list(edge=edge, Nnode=Nnode, tip.label=tip.labels, edge.length=edge.length)
class(ordertree) &lt;- &#39;phylo&#39;
plot(ordertree)</code></pre>
<p><img src="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>To visualize the results, we can add tip labels, node labels, and edge labels to the tree with the branch lengths:</p>
<pre class="r"><code>plot(ordertree)
tiplabels()
nodelabels()
edgelabels(ordertree$edge.length, bg=&quot;black&quot;, col=&quot;white&quot;, font=2)</code></pre>
<p><img src="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div id="getting-rid-of-fish" class="section level3">
<h3>Getting rid of fish</h3>
<p>Since I didn’t have fish, I needed to make a few modifications. First, <code>tip.labels</code> didn’t need “fish” in it anymore:</p>
<pre class="r"><code># remove &quot;fish&quot; from tip.labels:
tip.labels &lt;- c(&quot;amphib&quot;, &quot;squam&quot;, &quot;birds&quot;, &quot;mamm&quot;)</code></pre>
<p>Now, for the trickier part - I needed to modify the edge matrix. The edge matrix contains the starting and ending nodes for each edge in a tree. As we can see from the plot above, numbering works in the following way: the tips are numbered starting at the top from 1 to the number of tips and the nodes are numbered starting at the root and moving towards the tips. To get rid of fish, I needed to delete one tip from the tree and one node (the original root node). I sketched out what I wanted the new order tree to look like, complete with numbered nodes and tips, and created the following edge matrix:</p>
<pre class="r"><code>edge &lt;- matrix(c(7, 3,
  7, 2,
  6, 4,
  6, 7,
  5, 6,
  5, 1), byrow=TRUE, ncol=2)</code></pre>
<p>Since I was losing two edges from the phylogeny (the one going from the root to fish and the one from the root to the last common ancestor of tetrapods), I also needed to modify the edge lengths by removing 454.6-382.9 and 454.6:</p>
<pre class="r"><code>edge.length &lt;- c(274.9, 274.9, 324.5, 324.5-274.9, 382.9-324.5, 382.9)</code></pre>
<p>The final modification I needed was to decrease <code>Nnode</code> from 4 to 3:</p>
<pre class="r"><code>Nnode &lt;- 3</code></pre>
<p>So now…</p>
<pre class="r"><code>ordertree &lt;- list(edge=edge, Nnode=Nnode, tip.label=tip.labels, edge.length=edge.length)
class(ordertree) &lt;- &#39;phylo&#39;
plot(ordertree)
edgelabels(ordertree$edge.length, bg=&quot;black&quot;, col=&quot;white&quot;, font=2)</code></pre>
<p><img src="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/index_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>…I was ready to go with an order-level tree onto which I could graft my individual phylogenies!</p>
</div>
<div id="node-dates" class="section level3">
<h3>Node dates</h3>
<p>…Not so fast. I ended up with an additional problem I needed to solve before grafting the trees together. I ran into the error <code>'split_age' is inconsistent with edge lengths in 'phy'</code>, which means that the earliest node in one of my individual phylogenies was older than the node age I gave in <code>edge.length</code>. By <a href="https://babichmorrowc.github.io/post/debug-r/">using <code>debug</code></a>, I was able to tell that the error occurred when I added the squamate tree. The oldest node in my squamate tree was 277.8 million years ago, but I had set the divergence time between birds and squamates at 274.9 mya, so R was having problems. The species causing the problem was the tuatara, which is the only surviving member of its order.</p>
<figure>
<img class="special-img-class" style="width:75%" src="/img/tuatara.png" />
<figcaption>
The pesky (yet very cute) tuatara (<a href="https://www.australiangeographic.com.au/blogs/creatura-blog/2017/12/the-tuatara/" class="uri">https://www.australiangeographic.com.au/blogs/creatura-blog/2017/12/the-tuatara/</a>)
</figcaption>
</figure>
<p>I had a couple of choices: either delete the tuatara from the squamate phylogeny or increase the age of the last common ancestor of birds and squamates when I created the vector <code>edge.length</code>. I chose to do the latter because why get rid of such a cool animal!</p>
<p>I went to <a href="http://timetree.org/" class="uri">http://timetree.org/</a> to see if I could find a reasonable range of estimates for this node. According to the website, which allows you to search for the divergence time between any two taxa, the estimated divergence of birds and squamates occurred 280 mya.</p>
<figure>
<img class="special-img-class" style="width:75%" src="/img/timetree_birdsquamate.png" />
<figcaption>
TimeTree results for divergence time of birds and squamates.
</figcaption>
</figure>
<p>So I ended up with the following code and order tree:</p>
<pre class="r"><code>tip.labels &lt;- c(&quot;amphib&quot;, &quot;squam&quot;, &quot;birds&quot;, &quot;mamm&quot;)
edge &lt;- matrix(c(7, 3,
  7, 2,
  6, 4,
  6, 7,
  5, 6,
  5, 1), byrow=TRUE, ncol=2)
edge.length &lt;- c(280, 280, 324.5, 324.5-274.9, 382.9-324.5, 382.9)
Nnode &lt;- 3
ordertree &lt;- list(edge=edge, Nnode=Nnode, tip.label=tip.labels, edge.length=edge.length)
class(ordertree) &lt;- &#39;phylo&#39;
plot(ordertree)
edgelabels(ordertree$edge.length, bg=&quot;black&quot;, col=&quot;white&quot;, font=2)</code></pre>
<p><img src="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/index_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code>tree_list &lt;- list(amphib=amphibiantree, birds=birdtree, squam=squamatetree, mamm=mammaltree)
class(tree_list) &lt;- &quot;multiPhylo&quot;</code></pre>
</div>
</div>
<div id="grafting-the-trees" class="section level2">
<h2>Grafting the trees</h2>
<p>The final step is grafting the individual trees onto the order tree in the proper place.</p>
<pre class="r"><code>#Add taxonomic information to tree
otax &lt;- data.frame(&quot;Class&quot;= ordertree$tip.label, &quot;Superclass&quot;=c(rep(&quot;Tetrapoda&quot;,2)))
rownames(otax) &lt;- ordertree$tip.label
classtree &lt;- nodelabel.phylo(ordertree, otax, ncores=1)

res &lt;- glomogram.phylo(classtree, tree_list)
plot(res, type = &quot;fan&quot;, show.tip.label = FALSE)</code></pre>
<p><img src="https://babichmorrowc.github.io/blog/2019-01-09-grafting-trees/index_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Voila - a tree with 18262 species of tetrapods!</p>
</div>
</div>
<div id="disclaimer" class="section level1">
<h1>Disclaimer</h1>
<p>I’d like to finish this post with a disclaimer: I am NOT a phylogeneticist (yet?). The supertree created in this analysis incorporates several different phylogenies from literature and adapts code from another published article (all written by people with much more phylogenetic background than I!). However, the accuracy of the tree decreases as you move back in time - there is a great deal of uncertainty about node age for the deeper nodes in the tree. Even so, this process allows us to make some cool visualizations to compare major clades across vast stretches of evolutionary time - even if precise dates are incorrect, overall patterns are still informative!</p>
</div>
<div id="code" class="section level1">
<h1>Code</h1>
<p>The entire script I used for this process can be found at <a href="https://github.com/KerkhoffLab/bodymasspatterns/blob/master/tetrapod_phylogeny_code.R" class="uri">https://github.com/KerkhoffLab/bodymasspatterns/blob/master/tetrapod_phylogeny_code.R</a>.</p>
</div>
<div id="literature-cited" class="section level1">
<h1>Literature Cited</h1>
<p>Alfaro, M. E., F. Santini, C. Brock, H. Alamillo, A. Dornburg, D. L. Rabosky, G. Carnevale, and L. J. Harmon. 2009. Nine exceptional radiations plus high turnover explain species diversity in jawed vertebrates. PNAS 106:13410-13414.</p>
<p>Fritz, S. A., O. R. P. Bininda-Emonds, and A. Purvis. 2009. Geographical variation in predictors of mammalian extinction risk: big is bad, but only in the tropics. Ecology Letters 12:538–549.</p>
<p>Jetz, W., G. H. Thomas, J. B. Joy, K. Hartmann, and A. O. Mooers. 2012. The global diversity of birds in space and time. Nature 491:444.</p>
<p>O’Meara, B. C., L. J. Harmon, and J. Eastman. 2013. PhyloOrchard: Important and/or useful phylogenetic datasets.</p>
<p>Pyron, R. A. and J. J. Wiens. 2011. A large-scale phylogeny of Amphibia including over 2800 species, and a revised classification of extant frogs, salamanders, and caecilians. Molecular Phylogenetics and Evolution 61: 543-583.</p>
<p>Uyeda JC, Pennell MW, Miller ET, Maia R, McClain CR (2017) The evolution of energetic scaling across the vertebrate tree of life. The American Naturalist 190(2): 185-199. <a href="https://doi.org/10.1086/692326" class="uri">https://doi.org/10.1086/692326</a></p>
<p>Uyeda JC, Pennell MW, Miller ET, Maia R, McClain CR (2017) Data from: The evolution of energetic scaling across the vertebrate tree of life. Dryad Digital Repository. <a href="https://doi.org/10.5061/dryad.3c6d2" class="uri">https://doi.org/10.5061/dryad.3c6d2</a></p>
<p>Zheng, Y., and J. J. Wiens. 2016. Combining phylogenomic and supermatrix approaches, and a time-calibrated phylogeny for squamate reptiles (lizards and snakes) based on 52 genes and 4162 species. Molecular Phylogenetics and Evolution 94:537–547.</p>
</div>

        
        <details closed class="f6 fw7 input-reset">
  <dl class="f6 lh-copy">
    <dt class="fw7">Posted on:</dt>
    <dd class="fw5 ml0">January 18, 2019</dd>
  </dl>
  <dl class="f6 lh-copy">
    <dt class="fw7">Length:</dt>
    <dd class="fw5 ml0">9 minute read, 1706 words</dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Categories:</dt>
    <dd class="fw5 ml0"> <a href="https://babichmorrowc.github.io/categories/r">R</a>  <a href="https://babichmorrowc.github.io/categories/phylogenetics">phylogenetics</a>  <a href="https://babichmorrowc.github.io/categories/evolution">evolution</a> </dd>
  </dl>
  
  
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Tags:</dt>
    <dd class="fw5 ml0"> <a href="https://babichmorrowc.github.io/tags/r">R</a>  <a href="https://babichmorrowc.github.io/tags/phylogenetics">phylogenetics</a>  <a href="https://babichmorrowc.github.io/tags/evolution">evolution</a> </dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">See Also:</dt>
    
    <dd class="fw5 ml0"><a href="/blog/2024-09-23-bias-variance/">Bias-variance decomposition</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/2024-08-17-how-brat-is-it/">brat and it&#39;s the same but it&#39;s a blog post so it&#39;s not</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/2024-07-26-regularized_leastsquares/">Least squares regression: Part 2</a></dd>
    
  </dl>
</details>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="https://babichmorrowc.github.io/blog/2019-02-14-hackathon/">&larr; #HackTheSolarSystem</a>
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="https://babichmorrowc.github.io/blog/2019-01-03-debugging-r/">Debugging in R &rarr;</a>
  
</div>

      </footer>
    </article>
    
      <div class="post-comments pa0 pa4-l mt4">
  
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "babichmorrowc-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  
  
</div>

    
  </section>
</main>
<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2025 Cecina Babich Morrow, Anywhere
      <span class="middot-divider"></span>
      Made with <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Based on <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="/contact/" title="envelope" >
      <i class="fas fa-envelope fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/babichmorrowc" title="github" target="_blank" rel="me noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://scholar.google.com/citations?user=20mEEooAAAAJ&amp;hl=en" title="google-scholar" target="_blank" rel="me noopener">
      <i class="fab fa-google-scholar fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://orcid.org/my-orcid?orcid=0000-0003-2188-1495" title="orcid" target="_blank" rel="me noopener">
      <i class="fab fa-orcid fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://x.com/babichmorrowc" title="x-twitter" target="_blank" rel="me noopener">
      <i class="fab fa-x-twitter fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/license/" title="License">License</a>
      
      <a class="dib pv1 ph2 link" href="/contact/" title="Contact form">Contact</a>
      
      <a class="dib pv1 ph2 link" href="/contributors/" title="Contributors">Contributors</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
